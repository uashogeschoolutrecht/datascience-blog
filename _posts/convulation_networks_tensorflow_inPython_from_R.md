---
title: "TensorFlow examples in Python from RStudio"
author: "Marc A.T. Teunis, PhD" 
date: "2021-06-04 09:40:30"
output: 
  rmdformats::downcute:
    self_contained: TRUE
    number_sections: TRUE
    keep_md: TRUE
---



# Intro
I will try to run the Python script from RStudio, using the `{reticulate}` Python interface for R. The script we are going to run was derived [from](https://www.tensorflow.org/tutorials/quickstart/beginner) the beginners tutorial at the TensorFlow homepage. And can be found here: './py/tf_intro.py'

To get all files related to this tutorial, visit [this repo on Github:](https://github.com/uashogeschoolutrecht/python_from_rstudio) 

This short introduction uses Keras to:

    Build a neural network that classifies images.
    Train this neural network.
    And, finally, evaluate the accuracy of the model.

This document was build from RStudio using an RMarkdown literate programming script and was published to RStudio::CONNECT to host the html rendered version, you see here. The template used is ["rmdformats::downcute"](https://github.com/juba/rmdformats). Click this link for more details and more examples of other templates. The rendered version of this script is hosted [here](https://datascience.hu.nl/rsconnect/deep-learning-with-python-from-r/)

Download and install TensorFlow 2. Import TensorFlow into your Python environment. To keep things simple, I decided to install it in the base environment for now. I recommend to work with local virtual environments though.

Run the following one-time in the Terminal:


```bash
pip install tensorflow
pip install tensorflow_hub
pip install numpy
pip install pandas
```

# Packages and libraries
This loads the required R and Python packages to be able to run Python code in RStudio and to further process the model output in R. 

```r
library(tidyverse)
```

```
## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --
```

```
## v ggplot2 3.3.3     v purrr   0.3.4
## v tibble  3.1.1     v dplyr   1.0.5
## v tidyr   1.1.3     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.1
```

```
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
```

```r
library(reticulate)
```

Import python libraries in your R session

```r
reticulate::import("tensorflow")
```

```
## Module(tensorflow)
```


```python
import tensorflow as tf
```

# Load the data
Load and prepare the MNIST dataset. Convert the samples from integers to floating-point numbers:

```python
mnist = tf.keras.datasets.mnist

(x_train, y_train), (x_test, y_test) = mnist.load_data()
x_train, x_test = x_train / 255.0, x_test / 255.0
```

# Define model and Neural network
Build the tf.keras.Sequential model by stacking layers. Choose an optimizer and loss function for training:

```python
model = tf.keras.models.Sequential([
  tf.keras.layers.Flatten(input_shape=(28, 28)),
  tf.keras.layers.Dense(128, activation='relu'),
  tf.keras.layers.Dropout(0.2),
  tf.keras.layers.Dense(10)
])
```

# Get model metrics
For each example the model returns a vector of "logits" or "log-odds" scores, one for each class.

```python
predictions = model(x_train[:1]).numpy()
predictions
```

```
## array([[-0.0006487 ,  0.34140497,  0.40403882, -0.43397436,  0.01869112,
##         -0.3096119 ,  0.55257994, -0.4498397 ,  0.34858674, -0.15892099]],
##       dtype=float32)
```

The tf.nn.softmax function converts these logits to "probabilities" for each class:

```python
tf.nn.softmax(predictions).numpy()
```

```
## array([[0.09126288, 0.12848316, 0.13678792, 0.05917023, 0.09304508,
##         0.06700592, 0.15869321, 0.05823888, 0.12940922, 0.07790358]],
##       dtype=float32)
```

```python
loss_fn = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True)

loss_fn(y_train[:1], predictions).numpy()
```

```
## 2.7029743
```

This loss is equal to the negative log probability of the true class: It is zero if the model is sure of the correct class.

This untrained model gives probabilities close to random (1/10 for each class), so the initial loss should be close to -tf.math.log(1/10) ~= 2.3.

# Model fit
The Model.fit method adjusts the model parameters to minimize the loss:     

```python
model.compile(optimizer='adam',
              loss=loss_fn,
              metrics=['accuracy'])

model.fit(x_train, y_train, epochs=5)
```

```
## Epoch 1/5
## 
##    1/1875 [..............................] - ETA: 21:17 - loss: 2.4576 - accuracy: 0.0000e+00
##   28/1875 [..............................] - ETA: 3s - loss: 1.6419 - accuracy: 0.5268       
##   49/1875 [..............................] - ETA: 3s - loss: 1.2973 - accuracy: 0.6339
##   72/1875 [>.............................] - ETA: 3s - loss: 1.0957 - accuracy: 0.6927
##   99/1875 [>.............................] - ETA: 3s - loss: 0.9419 - accuracy: 0.7352
##  133/1875 [=>............................] - ETA: 3s - loss: 0.8239 - accuracy: 0.7648
##  153/1875 [=>............................] - ETA: 3s - loss: 0.7677 - accuracy: 0.7798
##  180/1875 [=>............................] - ETA: 3s - loss: 0.7132 - accuracy: 0.7951
##  217/1875 [==>...........................] - ETA: 3s - loss: 0.6633 - accuracy: 0.8082
##  251/1875 [===>..........................] - ETA: 2s - loss: 0.6311 - accuracy: 0.8167
##  277/1875 [===>..........................] - ETA: 2s - loss: 0.6088 - accuracy: 0.8228
##  310/1875 [===>..........................] - ETA: 2s - loss: 0.5882 - accuracy: 0.8279
##  349/1875 [====>.........................] - ETA: 2s - loss: 0.5613 - accuracy: 0.8356
##  376/1875 [=====>........................] - ETA: 2s - loss: 0.5444 - accuracy: 0.8408
##  407/1875 [=====>........................] - ETA: 2s - loss: 0.5289 - accuracy: 0.8455
##  441/1875 [======>.......................] - ETA: 2s - loss: 0.5121 - accuracy: 0.8504
##  463/1875 [======>.......................] - ETA: 2s - loss: 0.5040 - accuracy: 0.8526
##  495/1875 [======>.......................] - ETA: 2s - loss: 0.4920 - accuracy: 0.8559
##  528/1875 [=======>......................] - ETA: 2s - loss: 0.4779 - accuracy: 0.8599
##  556/1875 [=======>......................] - ETA: 2s - loss: 0.4686 - accuracy: 0.8621
##  593/1875 [========>.....................] - ETA: 2s - loss: 0.4560 - accuracy: 0.8663
##  631/1875 [=========>....................] - ETA: 2s - loss: 0.4455 - accuracy: 0.8689
##  663/1875 [=========>....................] - ETA: 2s - loss: 0.4390 - accuracy: 0.8705
##  695/1875 [==========>...................] - ETA: 1s - loss: 0.4328 - accuracy: 0.8719
##  722/1875 [==========>...................] - ETA: 1s - loss: 0.4274 - accuracy: 0.8737
##  747/1875 [==========>...................] - ETA: 1s - loss: 0.4212 - accuracy: 0.8757
##  777/1875 [===========>..................] - ETA: 1s - loss: 0.4145 - accuracy: 0.8781
##  806/1875 [===========>..................] - ETA: 1s - loss: 0.4082 - accuracy: 0.8801
##  832/1875 [============>.................] - ETA: 1s - loss: 0.4030 - accuracy: 0.8815
##  860/1875 [============>.................] - ETA: 1s - loss: 0.3974 - accuracy: 0.8834
##  888/1875 [=============>................] - ETA: 1s - loss: 0.3926 - accuracy: 0.8849
##  911/1875 [=============>................] - ETA: 1s - loss: 0.3891 - accuracy: 0.8859
##  946/1875 [==============>...............] - ETA: 1s - loss: 0.3829 - accuracy: 0.8874
##  984/1875 [==============>...............] - ETA: 1s - loss: 0.3774 - accuracy: 0.8890
## 1018/1875 [===============>..............] - ETA: 1s - loss: 0.3722 - accuracy: 0.8902
## 1046/1875 [===============>..............] - ETA: 1s - loss: 0.3674 - accuracy: 0.8917
## 1084/1875 [================>.............] - ETA: 1s - loss: 0.3633 - accuracy: 0.8930
## 1113/1875 [================>.............] - ETA: 1s - loss: 0.3603 - accuracy: 0.8939
## 1146/1875 [=================>............] - ETA: 1s - loss: 0.3560 - accuracy: 0.8953
## 1176/1875 [=================>............] - ETA: 1s - loss: 0.3525 - accuracy: 0.8964
## 1215/1875 [==================>...........] - ETA: 1s - loss: 0.3494 - accuracy: 0.8975
## 1226/1875 [==================>...........] - ETA: 1s - loss: 0.3484 - accuracy: 0.8976
## 1251/1875 [===================>..........] - ETA: 1s - loss: 0.3458 - accuracy: 0.8985
## 1274/1875 [===================>..........] - ETA: 1s - loss: 0.3437 - accuracy: 0.8990
## 1298/1875 [===================>..........] - ETA: 0s - loss: 0.3418 - accuracy: 0.8995
## 1322/1875 [====================>.........] - ETA: 0s - loss: 0.3395 - accuracy: 0.9000
## 1350/1875 [====================>.........] - ETA: 0s - loss: 0.3359 - accuracy: 0.9011
## 1374/1875 [====================>.........] - ETA: 0s - loss: 0.3339 - accuracy: 0.9016
## 1397/1875 [=====================>........] - ETA: 0s - loss: 0.3315 - accuracy: 0.9022
## 1423/1875 [=====================>........] - ETA: 0s - loss: 0.3295 - accuracy: 0.9027
## 1448/1875 [======================>.......] - ETA: 0s - loss: 0.3271 - accuracy: 0.9033
## 1477/1875 [======================>.......] - ETA: 0s - loss: 0.3248 - accuracy: 0.9041
## 1502/1875 [=======================>......] - ETA: 0s - loss: 0.3226 - accuracy: 0.9048
## 1524/1875 [=======================>......] - ETA: 0s - loss: 0.3206 - accuracy: 0.9053
## 1549/1875 [=======================>......] - ETA: 0s - loss: 0.3179 - accuracy: 0.9061
## 1574/1875 [========================>.....] - ETA: 0s - loss: 0.3158 - accuracy: 0.9068
## 1596/1875 [========================>.....] - ETA: 0s - loss: 0.3136 - accuracy: 0.9076
## 1617/1875 [========================>.....] - ETA: 0s - loss: 0.3118 - accuracy: 0.9080
## 1644/1875 [=========================>....] - ETA: 0s - loss: 0.3101 - accuracy: 0.9085
## 1662/1875 [=========================>....] - ETA: 0s - loss: 0.3086 - accuracy: 0.9089
## 1684/1875 [=========================>....] - ETA: 0s - loss: 0.3068 - accuracy: 0.9095
## 1712/1875 [==========================>...] - ETA: 0s - loss: 0.3051 - accuracy: 0.9100
## 1741/1875 [==========================>...] - ETA: 0s - loss: 0.3028 - accuracy: 0.9107
## 1769/1875 [===========================>..] - ETA: 0s - loss: 0.3003 - accuracy: 0.9114
## 1801/1875 [===========================>..] - ETA: 0s - loss: 0.2983 - accuracy: 0.9119
## 1824/1875 [============================>.] - ETA: 0s - loss: 0.2968 - accuracy: 0.9124
## 1845/1875 [============================>.] - ETA: 0s - loss: 0.2955 - accuracy: 0.9129
## 1875/1875 [==============================] - 4s 2ms/step - loss: 0.2933 - accuracy: 0.9134
## Epoch 2/5
## 
##    1/1875 [..............................] - ETA: 1s - loss: 0.2390 - accuracy: 0.9062
##   22/1875 [..............................] - ETA: 4s - loss: 0.1733 - accuracy: 0.9503
##   47/1875 [..............................] - ETA: 4s - loss: 0.1632 - accuracy: 0.9555
##   70/1875 [>.............................] - ETA: 3s - loss: 0.1655 - accuracy: 0.9496
##   93/1875 [>.............................] - ETA: 3s - loss: 0.1701 - accuracy: 0.9499
##  113/1875 [>.............................] - ETA: 3s - loss: 0.1656 - accuracy: 0.9494
##  139/1875 [=>............................] - ETA: 3s - loss: 0.1654 - accuracy: 0.9499
##  166/1875 [=>............................] - ETA: 3s - loss: 0.1637 - accuracy: 0.9497
##  196/1875 [==>...........................] - ETA: 3s - loss: 0.1603 - accuracy: 0.9496
##  224/1875 [==>...........................] - ETA: 3s - loss: 0.1595 - accuracy: 0.9499
##  255/1875 [===>..........................] - ETA: 3s - loss: 0.1585 - accuracy: 0.9506
##  275/1875 [===>..........................] - ETA: 3s - loss: 0.1584 - accuracy: 0.9507
##  302/1875 [===>..........................] - ETA: 3s - loss: 0.1553 - accuracy: 0.9514
##  324/1875 [====>.........................] - ETA: 3s - loss: 0.1558 - accuracy: 0.9515
##  347/1875 [====>.........................] - ETA: 3s - loss: 0.1554 - accuracy: 0.9522
##  371/1875 [====>.........................] - ETA: 3s - loss: 0.1548 - accuracy: 0.9518
##  393/1875 [=====>........................] - ETA: 3s - loss: 0.1542 - accuracy: 0.9523
##  412/1875 [=====>........................] - ETA: 3s - loss: 0.1515 - accuracy: 0.9532
##  434/1875 [=====>........................] - ETA: 3s - loss: 0.1504 - accuracy: 0.9534
##  456/1875 [======>.......................] - ETA: 3s - loss: 0.1515 - accuracy: 0.9531
##  481/1875 [======>.......................] - ETA: 2s - loss: 0.1517 - accuracy: 0.9530
##  506/1875 [=======>......................] - ETA: 2s - loss: 0.1518 - accuracy: 0.9531
##  532/1875 [=======>......................] - ETA: 2s - loss: 0.1503 - accuracy: 0.9538
##  549/1875 [=======>......................] - ETA: 2s - loss: 0.1497 - accuracy: 0.9541
##  573/1875 [========>.....................] - ETA: 2s - loss: 0.1494 - accuracy: 0.9541
##  604/1875 [========>.....................] - ETA: 2s - loss: 0.1503 - accuracy: 0.9538
##  629/1875 [=========>....................] - ETA: 2s - loss: 0.1506 - accuracy: 0.9537
##  657/1875 [=========>....................] - ETA: 2s - loss: 0.1504 - accuracy: 0.9541
##  684/1875 [=========>....................] - ETA: 2s - loss: 0.1503 - accuracy: 0.9542
##  710/1875 [==========>...................] - ETA: 2s - loss: 0.1494 - accuracy: 0.9545
##  731/1875 [==========>...................] - ETA: 2s - loss: 0.1489 - accuracy: 0.9546
##  753/1875 [===========>..................] - ETA: 2s - loss: 0.1492 - accuracy: 0.9546
##  787/1875 [===========>..................] - ETA: 2s - loss: 0.1508 - accuracy: 0.9540
##  810/1875 [===========>..................] - ETA: 2s - loss: 0.1514 - accuracy: 0.9539
##  829/1875 [============>.................] - ETA: 2s - loss: 0.1511 - accuracy: 0.9539
##  855/1875 [============>.................] - ETA: 2s - loss: 0.1516 - accuracy: 0.9539
##  881/1875 [=============>................] - ETA: 2s - loss: 0.1516 - accuracy: 0.9540
##  904/1875 [=============>................] - ETA: 2s - loss: 0.1516 - accuracy: 0.9541
##  940/1875 [==============>...............] - ETA: 1s - loss: 0.1509 - accuracy: 0.9546
##  965/1875 [==============>...............] - ETA: 1s - loss: 0.1507 - accuracy: 0.9545
##  988/1875 [==============>...............] - ETA: 1s - loss: 0.1511 - accuracy: 0.9546
## 1015/1875 [===============>..............] - ETA: 1s - loss: 0.1510 - accuracy: 0.9547
## 1037/1875 [===============>..............] - ETA: 1s - loss: 0.1513 - accuracy: 0.9547
## 1057/1875 [===============>..............] - ETA: 1s - loss: 0.1520 - accuracy: 0.9547
## 1076/1875 [================>.............] - ETA: 1s - loss: 0.1527 - accuracy: 0.9545
## 1095/1875 [================>.............] - ETA: 1s - loss: 0.1524 - accuracy: 0.9546
## 1114/1875 [================>.............] - ETA: 1s - loss: 0.1518 - accuracy: 0.9546
## 1137/1875 [=================>............] - ETA: 1s - loss: 0.1510 - accuracy: 0.9548
## 1159/1875 [=================>............] - ETA: 1s - loss: 0.1507 - accuracy: 0.9550
## 1187/1875 [=================>............] - ETA: 1s - loss: 0.1504 - accuracy: 0.9551
## 1204/1875 [==================>...........] - ETA: 1s - loss: 0.1501 - accuracy: 0.9552
## 1222/1875 [==================>...........] - ETA: 1s - loss: 0.1503 - accuracy: 0.9552
## 1239/1875 [==================>...........] - ETA: 1s - loss: 0.1505 - accuracy: 0.9552
## 1264/1875 [===================>..........] - ETA: 1s - loss: 0.1501 - accuracy: 0.9553
## 1282/1875 [===================>..........] - ETA: 1s - loss: 0.1504 - accuracy: 0.9554
## 1295/1875 [===================>..........] - ETA: 1s - loss: 0.1504 - accuracy: 0.9554
## 1311/1875 [===================>..........] - ETA: 1s - loss: 0.1503 - accuracy: 0.9554
## 1339/1875 [====================>.........] - ETA: 1s - loss: 0.1498 - accuracy: 0.9554
## 1359/1875 [====================>.........] - ETA: 1s - loss: 0.1494 - accuracy: 0.9556
## 1391/1875 [=====================>........] - ETA: 1s - loss: 0.1492 - accuracy: 0.9556
## 1416/1875 [=====================>........] - ETA: 0s - loss: 0.1488 - accuracy: 0.9557
## 1439/1875 [======================>.......] - ETA: 0s - loss: 0.1486 - accuracy: 0.9556
## 1461/1875 [======================>.......] - ETA: 0s - loss: 0.1486 - accuracy: 0.9555
## 1495/1875 [======================>.......] - ETA: 0s - loss: 0.1489 - accuracy: 0.9555
## 1520/1875 [=======================>......] - ETA: 0s - loss: 0.1487 - accuracy: 0.9556
## 1538/1875 [=======================>......] - ETA: 0s - loss: 0.1489 - accuracy: 0.9556
## 1560/1875 [=======================>......] - ETA: 0s - loss: 0.1489 - accuracy: 0.9555
## 1590/1875 [========================>.....] - ETA: 0s - loss: 0.1483 - accuracy: 0.9557
## 1611/1875 [========================>.....] - ETA: 0s - loss: 0.1484 - accuracy: 0.9558
## 1633/1875 [=========================>....] - ETA: 0s - loss: 0.1483 - accuracy: 0.9557
## 1656/1875 [=========================>....] - ETA: 0s - loss: 0.1477 - accuracy: 0.9560
## 1678/1875 [=========================>....] - ETA: 0s - loss: 0.1475 - accuracy: 0.9560
## 1704/1875 [==========================>...] - ETA: 0s - loss: 0.1471 - accuracy: 0.9561
## 1731/1875 [==========================>...] - ETA: 0s - loss: 0.1468 - accuracy: 0.9562
## 1753/1875 [===========================>..] - ETA: 0s - loss: 0.1462 - accuracy: 0.9564
## 1777/1875 [===========================>..] - ETA: 0s - loss: 0.1463 - accuracy: 0.9565
## 1806/1875 [===========================>..] - ETA: 0s - loss: 0.1458 - accuracy: 0.9566
## 1827/1875 [============================>.] - ETA: 0s - loss: 0.1458 - accuracy: 0.9566
## 1844/1875 [============================>.] - ETA: 0s - loss: 0.1453 - accuracy: 0.9567
## 1868/1875 [============================>.] - ETA: 0s - loss: 0.1453 - accuracy: 0.9567
## 1875/1875 [==============================] - 4s 2ms/step - loss: 0.1450 - accuracy: 0.9568
## Epoch 3/5
## 
##    1/1875 [..............................] - ETA: 3s - loss: 0.1822 - accuracy: 0.9375
##   26/1875 [..............................] - ETA: 3s - loss: 0.0974 - accuracy: 0.9724
##   38/1875 [..............................] - ETA: 5s - loss: 0.0996 - accuracy: 0.9696
##   56/1875 [..............................] - ETA: 5s - loss: 0.0954 - accuracy: 0.9715
##   74/1875 [>.............................] - ETA: 5s - loss: 0.0973 - accuracy: 0.9713
##   90/1875 [>.............................] - ETA: 5s - loss: 0.0920 - accuracy: 0.9733
##  107/1875 [>.............................] - ETA: 5s - loss: 0.0909 - accuracy: 0.9737
##  126/1875 [=>............................] - ETA: 5s - loss: 0.0972 - accuracy: 0.9707
##  141/1875 [=>............................] - ETA: 5s - loss: 0.0976 - accuracy: 0.9701
##  154/1875 [=>............................] - ETA: 5s - loss: 0.1011 - accuracy: 0.9692
##  166/1875 [=>............................] - ETA: 5s - loss: 0.1036 - accuracy: 0.9686
##  179/1875 [=>............................] - ETA: 5s - loss: 0.1041 - accuracy: 0.9681
##  194/1875 [==>...........................] - ETA: 5s - loss: 0.1060 - accuracy: 0.9668
##  213/1875 [==>...........................] - ETA: 5s - loss: 0.1077 - accuracy: 0.9663
##  227/1875 [==>...........................] - ETA: 5s - loss: 0.1086 - accuracy: 0.9656
##  238/1875 [==>...........................] - ETA: 5s - loss: 0.1086 - accuracy: 0.9661
##  251/1875 [===>..........................] - ETA: 5s - loss: 0.1079 - accuracy: 0.9666
##  263/1875 [===>..........................] - ETA: 5s - loss: 0.1071 - accuracy: 0.9668
##  277/1875 [===>..........................] - ETA: 5s - loss: 0.1062 - accuracy: 0.9674
##  293/1875 [===>..........................] - ETA: 5s - loss: 0.1060 - accuracy: 0.9677
##  315/1875 [====>.........................] - ETA: 5s - loss: 0.1053 - accuracy: 0.9675
##  337/1875 [====>.........................] - ETA: 4s - loss: 0.1044 - accuracy: 0.9678
##  353/1875 [====>.........................] - ETA: 4s - loss: 0.1049 - accuracy: 0.9677
##  370/1875 [====>.........................] - ETA: 4s - loss: 0.1056 - accuracy: 0.9674
##  398/1875 [=====>........................] - ETA: 4s - loss: 0.1039 - accuracy: 0.9684
##  422/1875 [=====>........................] - ETA: 4s - loss: 0.1041 - accuracy: 0.9682
##  449/1875 [======>.......................] - ETA: 4s - loss: 0.1045 - accuracy: 0.9679
##  467/1875 [======>.......................] - ETA: 4s - loss: 0.1041 - accuracy: 0.9679
##  491/1875 [======>.......................] - ETA: 4s - loss: 0.1075 - accuracy: 0.9672
##  512/1875 [=======>......................] - ETA: 4s - loss: 0.1078 - accuracy: 0.9673
##  544/1875 [=======>......................] - ETA: 3s - loss: 0.1072 - accuracy: 0.9673
##  568/1875 [========>.....................] - ETA: 3s - loss: 0.1082 - accuracy: 0.9672
##  592/1875 [========>.....................] - ETA: 3s - loss: 0.1077 - accuracy: 0.9675
##  610/1875 [========>.....................] - ETA: 3s - loss: 0.1073 - accuracy: 0.9676
##  625/1875 [=========>....................] - ETA: 3s - loss: 0.1074 - accuracy: 0.9676
##  643/1875 [=========>....................] - ETA: 3s - loss: 0.1071 - accuracy: 0.9678
##  675/1875 [=========>....................] - ETA: 3s - loss: 0.1071 - accuracy: 0.9678
##  704/1875 [==========>...................] - ETA: 3s - loss: 0.1077 - accuracy: 0.9676
##  732/1875 [==========>...................] - ETA: 3s - loss: 0.1091 - accuracy: 0.9670
##  758/1875 [===========>..................] - ETA: 2s - loss: 0.1093 - accuracy: 0.9667
##  788/1875 [===========>..................] - ETA: 2s - loss: 0.1088 - accuracy: 0.9669
##  808/1875 [===========>..................] - ETA: 2s - loss: 0.1091 - accuracy: 0.9668
##  836/1875 [============>.................] - ETA: 2s - loss: 0.1088 - accuracy: 0.9669
##  865/1875 [============>.................] - ETA: 2s - loss: 0.1081 - accuracy: 0.9671
##  892/1875 [=============>................] - ETA: 2s - loss: 0.1083 - accuracy: 0.9669
##  916/1875 [=============>................] - ETA: 2s - loss: 0.1085 - accuracy: 0.9669
##  949/1875 [==============>...............] - ETA: 2s - loss: 0.1082 - accuracy: 0.9672
##  968/1875 [==============>...............] - ETA: 2s - loss: 0.1082 - accuracy: 0.9673
##  983/1875 [==============>...............] - ETA: 2s - loss: 0.1080 - accuracy: 0.9673
## 1000/1875 [===============>..............] - ETA: 2s - loss: 0.1084 - accuracy: 0.9672
## 1020/1875 [===============>..............] - ETA: 2s - loss: 0.1081 - accuracy: 0.9675
## 1046/1875 [===============>..............] - ETA: 2s - loss: 0.1078 - accuracy: 0.9676
## 1076/1875 [================>.............] - ETA: 1s - loss: 0.1070 - accuracy: 0.9678
## 1096/1875 [================>.............] - ETA: 1s - loss: 0.1073 - accuracy: 0.9676
## 1116/1875 [================>.............] - ETA: 1s - loss: 0.1075 - accuracy: 0.9677
## 1152/1875 [=================>............] - ETA: 1s - loss: 0.1078 - accuracy: 0.9674
## 1182/1875 [=================>............] - ETA: 1s - loss: 0.1079 - accuracy: 0.9674
## 1209/1875 [==================>...........] - ETA: 1s - loss: 0.1080 - accuracy: 0.9674
## 1236/1875 [==================>...........] - ETA: 1s - loss: 0.1078 - accuracy: 0.9673
## 1258/1875 [===================>..........] - ETA: 1s - loss: 0.1081 - accuracy: 0.9673
## 1288/1875 [===================>..........] - ETA: 1s - loss: 0.1079 - accuracy: 0.9674
## 1313/1875 [====================>.........] - ETA: 1s - loss: 0.1072 - accuracy: 0.9676
## 1344/1875 [====================>.........] - ETA: 1s - loss: 0.1071 - accuracy: 0.9676
## 1366/1875 [====================>.........] - ETA: 1s - loss: 0.1064 - accuracy: 0.9679
## 1389/1875 [=====================>........] - ETA: 1s - loss: 0.1066 - accuracy: 0.9677
## 1415/1875 [=====================>........] - ETA: 1s - loss: 0.1068 - accuracy: 0.9677
## 1438/1875 [======================>.......] - ETA: 1s - loss: 0.1069 - accuracy: 0.9677
## 1462/1875 [======================>.......] - ETA: 0s - loss: 0.1066 - accuracy: 0.9677
## 1489/1875 [======================>.......] - ETA: 0s - loss: 0.1068 - accuracy: 0.9677
## 1508/1875 [=======================>......] - ETA: 0s - loss: 0.1068 - accuracy: 0.9677
## 1540/1875 [=======================>......] - ETA: 0s - loss: 0.1068 - accuracy: 0.9678
## 1573/1875 [========================>.....] - ETA: 0s - loss: 0.1071 - accuracy: 0.9677
## 1597/1875 [========================>.....] - ETA: 0s - loss: 0.1071 - accuracy: 0.9678
## 1622/1875 [========================>.....] - ETA: 0s - loss: 0.1069 - accuracy: 0.9678
## 1642/1875 [=========================>....] - ETA: 0s - loss: 0.1067 - accuracy: 0.9679
## 1668/1875 [=========================>....] - ETA: 0s - loss: 0.1067 - accuracy: 0.9679
## 1697/1875 [==========================>...] - ETA: 0s - loss: 0.1071 - accuracy: 0.9678
## 1721/1875 [==========================>...] - ETA: 0s - loss: 0.1069 - accuracy: 0.9677
## 1753/1875 [===========================>..] - ETA: 0s - loss: 0.1066 - accuracy: 0.9678
## 1773/1875 [===========================>..] - ETA: 0s - loss: 0.1072 - accuracy: 0.9677
## 1793/1875 [===========================>..] - ETA: 0s - loss: 0.1072 - accuracy: 0.9676
## 1816/1875 [============================>.] - ETA: 0s - loss: 0.1071 - accuracy: 0.9677
## 1834/1875 [============================>.] - ETA: 0s - loss: 0.1068 - accuracy: 0.9677
## 1857/1875 [============================>.] - ETA: 0s - loss: 0.1065 - accuracy: 0.9678
## 1875/1875 [==============================] - 4s 2ms/step - loss: 0.1062 - accuracy: 0.9679
## Epoch 4/5
## 
##    1/1875 [..............................] - ETA: 3s - loss: 0.0669 - accuracy: 0.9688
##   20/1875 [..............................] - ETA: 5s - loss: 0.0822 - accuracy: 0.9672
##   49/1875 [..............................] - ETA: 4s - loss: 0.0902 - accuracy: 0.9668
##   76/1875 [>.............................] - ETA: 3s - loss: 0.0971 - accuracy: 0.9675
##   92/1875 [>.............................] - ETA: 4s - loss: 0.0949 - accuracy: 0.9688
##  117/1875 [>.............................] - ETA: 3s - loss: 0.0934 - accuracy: 0.9704
##  140/1875 [=>............................] - ETA: 3s - loss: 0.0920 - accuracy: 0.9708
##  165/1875 [=>............................] - ETA: 3s - loss: 0.0951 - accuracy: 0.9697
##  189/1875 [==>...........................] - ETA: 3s - loss: 0.0951 - accuracy: 0.9702
##  209/1875 [==>...........................] - ETA: 3s - loss: 0.0930 - accuracy: 0.9704
##  228/1875 [==>...........................] - ETA: 3s - loss: 0.0929 - accuracy: 0.9700
##  248/1875 [==>...........................] - ETA: 3s - loss: 0.0927 - accuracy: 0.9700
##  269/1875 [===>..........................] - ETA: 3s - loss: 0.0919 - accuracy: 0.9707
##  290/1875 [===>..........................] - ETA: 3s - loss: 0.0911 - accuracy: 0.9711
##  321/1875 [====>.........................] - ETA: 3s - loss: 0.0910 - accuracy: 0.9712
##  350/1875 [====>.........................] - ETA: 3s - loss: 0.0900 - accuracy: 0.9714
##  379/1875 [=====>........................] - ETA: 3s - loss: 0.0891 - accuracy: 0.9715
##  402/1875 [=====>........................] - ETA: 3s - loss: 0.0888 - accuracy: 0.9713
##  440/1875 [======>.......................] - ETA: 3s - loss: 0.0894 - accuracy: 0.9714
##  464/1875 [======>.......................] - ETA: 2s - loss: 0.0894 - accuracy: 0.9718
##  495/1875 [======>.......................] - ETA: 2s - loss: 0.0882 - accuracy: 0.9723
##  521/1875 [=======>......................] - ETA: 2s - loss: 0.0876 - accuracy: 0.9722
##  544/1875 [=======>......................] - ETA: 2s - loss: 0.0869 - accuracy: 0.9725
##  564/1875 [========>.....................] - ETA: 2s - loss: 0.0866 - accuracy: 0.9727
##  591/1875 [========>.....................] - ETA: 2s - loss: 0.0869 - accuracy: 0.9725
##  618/1875 [========>.....................] - ETA: 2s - loss: 0.0872 - accuracy: 0.9722
##  646/1875 [=========>....................] - ETA: 2s - loss: 0.0874 - accuracy: 0.9722
##  678/1875 [=========>....................] - ETA: 2s - loss: 0.0882 - accuracy: 0.9718
##  712/1875 [==========>...................] - ETA: 2s - loss: 0.0891 - accuracy: 0.9714
##  744/1875 [==========>...................] - ETA: 2s - loss: 0.0888 - accuracy: 0.9714
##  774/1875 [===========>..................] - ETA: 2s - loss: 0.0896 - accuracy: 0.9711
##  807/1875 [===========>..................] - ETA: 2s - loss: 0.0897 - accuracy: 0.9710
##  834/1875 [============>.................] - ETA: 2s - loss: 0.0888 - accuracy: 0.9715
##  870/1875 [============>.................] - ETA: 1s - loss: 0.0892 - accuracy: 0.9713
##  911/1875 [=============>................] - ETA: 1s - loss: 0.0892 - accuracy: 0.9712
##  938/1875 [==============>...............] - ETA: 1s - loss: 0.0892 - accuracy: 0.9711
##  958/1875 [==============>...............] - ETA: 1s - loss: 0.0893 - accuracy: 0.9711
##  988/1875 [==============>...............] - ETA: 1s - loss: 0.0895 - accuracy: 0.9710
## 1015/1875 [===============>..............] - ETA: 1s - loss: 0.0897 - accuracy: 0.9710
## 1047/1875 [===============>..............] - ETA: 1s - loss: 0.0894 - accuracy: 0.9710
## 1082/1875 [================>.............] - ETA: 1s - loss: 0.0893 - accuracy: 0.9711
## 1118/1875 [================>.............] - ETA: 1s - loss: 0.0887 - accuracy: 0.9715
## 1141/1875 [=================>............] - ETA: 1s - loss: 0.0886 - accuracy: 0.9716
## 1165/1875 [=================>............] - ETA: 1s - loss: 0.0884 - accuracy: 0.9717
## 1192/1875 [==================>...........] - ETA: 1s - loss: 0.0884 - accuracy: 0.9719
## 1215/1875 [==================>...........] - ETA: 1s - loss: 0.0880 - accuracy: 0.9721
## 1251/1875 [===================>..........] - ETA: 1s - loss: 0.0874 - accuracy: 0.9723
## 1274/1875 [===================>..........] - ETA: 1s - loss: 0.0885 - accuracy: 0.9719
## 1298/1875 [===================>..........] - ETA: 1s - loss: 0.0888 - accuracy: 0.9719
## 1332/1875 [====================>.........] - ETA: 1s - loss: 0.0890 - accuracy: 0.9719
## 1371/1875 [====================>.........] - ETA: 0s - loss: 0.0882 - accuracy: 0.9721
## 1406/1875 [=====================>........] - ETA: 0s - loss: 0.0883 - accuracy: 0.9720
## 1418/1875 [=====================>........] - ETA: 0s - loss: 0.0882 - accuracy: 0.9721
## 1438/1875 [======================>.......] - ETA: 0s - loss: 0.0880 - accuracy: 0.9721
## 1464/1875 [======================>.......] - ETA: 0s - loss: 0.0875 - accuracy: 0.9723
## 1492/1875 [======================>.......] - ETA: 0s - loss: 0.0876 - accuracy: 0.9724
## 1522/1875 [=======================>......] - ETA: 0s - loss: 0.0873 - accuracy: 0.9725
## 1544/1875 [=======================>......] - ETA: 0s - loss: 0.0870 - accuracy: 0.9726
## 1570/1875 [========================>.....] - ETA: 0s - loss: 0.0877 - accuracy: 0.9725
## 1608/1875 [========================>.....] - ETA: 0s - loss: 0.0876 - accuracy: 0.9726
## 1639/1875 [=========================>....] - ETA: 0s - loss: 0.0875 - accuracy: 0.9727
## 1665/1875 [=========================>....] - ETA: 0s - loss: 0.0874 - accuracy: 0.9727
## 1694/1875 [==========================>...] - ETA: 0s - loss: 0.0879 - accuracy: 0.9725
## 1719/1875 [==========================>...] - ETA: 0s - loss: 0.0876 - accuracy: 0.9726
## 1752/1875 [===========================>..] - ETA: 0s - loss: 0.0878 - accuracy: 0.9724
## 1782/1875 [===========================>..] - ETA: 0s - loss: 0.0877 - accuracy: 0.9725
## 1796/1875 [===========================>..] - ETA: 0s - loss: 0.0876 - accuracy: 0.9725
## 1811/1875 [===========================>..] - ETA: 0s - loss: 0.0876 - accuracy: 0.9725
## 1828/1875 [============================>.] - ETA: 0s - loss: 0.0879 - accuracy: 0.9725
## 1858/1875 [============================>.] - ETA: 0s - loss: 0.0880 - accuracy: 0.9724
## 1875/1875 [==============================] - 4s 2ms/step - loss: 0.0879 - accuracy: 0.9724
## Epoch 5/5
## 
##    1/1875 [..............................] - ETA: 3s - loss: 0.0504 - accuracy: 0.9688
##   40/1875 [..............................] - ETA: 2s - loss: 0.0562 - accuracy: 0.9820
##   70/1875 [>.............................] - ETA: 2s - loss: 0.0616 - accuracy: 0.9817
##   96/1875 [>.............................] - ETA: 2s - loss: 0.0621 - accuracy: 0.9821
##  134/1875 [=>............................] - ETA: 2s - loss: 0.0620 - accuracy: 0.9823
##  162/1875 [=>............................] - ETA: 2s - loss: 0.0629 - accuracy: 0.9821
##  195/1875 [==>...........................] - ETA: 2s - loss: 0.0635 - accuracy: 0.9811
##  226/1875 [==>...........................] - ETA: 2s - loss: 0.0672 - accuracy: 0.9802
##  252/1875 [===>..........................] - ETA: 2s - loss: 0.0706 - accuracy: 0.9788
##  275/1875 [===>..........................] - ETA: 2s - loss: 0.0710 - accuracy: 0.9783
##  303/1875 [===>..........................] - ETA: 2s - loss: 0.0691 - accuracy: 0.9787
##  322/1875 [====>.........................] - ETA: 2s - loss: 0.0705 - accuracy: 0.9785
##  338/1875 [====>.........................] - ETA: 2s - loss: 0.0698 - accuracy: 0.9787
##  362/1875 [====>.........................] - ETA: 2s - loss: 0.0704 - accuracy: 0.9784
##  383/1875 [=====>........................] - ETA: 2s - loss: 0.0707 - accuracy: 0.9780
##  405/1875 [=====>........................] - ETA: 2s - loss: 0.0704 - accuracy: 0.9777
##  431/1875 [=====>........................] - ETA: 2s - loss: 0.0709 - accuracy: 0.9777
##  458/1875 [======>.......................] - ETA: 2s - loss: 0.0703 - accuracy: 0.9776
##  482/1875 [======>.......................] - ETA: 2s - loss: 0.0705 - accuracy: 0.9776
##  501/1875 [=======>......................] - ETA: 2s - loss: 0.0702 - accuracy: 0.9777
##  524/1875 [=======>......................] - ETA: 2s - loss: 0.0699 - accuracy: 0.9780
##  549/1875 [=======>......................] - ETA: 2s - loss: 0.0689 - accuracy: 0.9785
##  575/1875 [========>.....................] - ETA: 2s - loss: 0.0707 - accuracy: 0.9780
##  606/1875 [========>.....................] - ETA: 2s - loss: 0.0710 - accuracy: 0.9780
##  636/1875 [=========>....................] - ETA: 2s - loss: 0.0719 - accuracy: 0.9773
##  661/1875 [=========>....................] - ETA: 2s - loss: 0.0719 - accuracy: 0.9777
##  693/1875 [==========>...................] - ETA: 2s - loss: 0.0717 - accuracy: 0.9777
##  719/1875 [==========>...................] - ETA: 2s - loss: 0.0718 - accuracy: 0.9777
##  748/1875 [==========>...................] - ETA: 2s - loss: 0.0715 - accuracy: 0.9777
##  774/1875 [===========>..................] - ETA: 2s - loss: 0.0714 - accuracy: 0.9775
##  800/1875 [===========>..................] - ETA: 2s - loss: 0.0716 - accuracy: 0.9775
##  832/1875 [============>.................] - ETA: 1s - loss: 0.0721 - accuracy: 0.9771
##  861/1875 [============>.................] - ETA: 1s - loss: 0.0717 - accuracy: 0.9774
##  891/1875 [=============>................] - ETA: 1s - loss: 0.0717 - accuracy: 0.9775
##  918/1875 [=============>................] - ETA: 1s - loss: 0.0718 - accuracy: 0.9775
##  943/1875 [==============>...............] - ETA: 1s - loss: 0.0715 - accuracy: 0.9778
##  975/1875 [==============>...............] - ETA: 1s - loss: 0.0717 - accuracy: 0.9776
##  991/1875 [==============>...............] - ETA: 1s - loss: 0.0716 - accuracy: 0.9776
## 1010/1875 [===============>..............] - ETA: 1s - loss: 0.0719 - accuracy: 0.9775
## 1037/1875 [===============>..............] - ETA: 1s - loss: 0.0719 - accuracy: 0.9775
## 1059/1875 [===============>..............] - ETA: 1s - loss: 0.0718 - accuracy: 0.9776
## 1079/1875 [================>.............] - ETA: 1s - loss: 0.0722 - accuracy: 0.9775
## 1104/1875 [================>.............] - ETA: 1s - loss: 0.0723 - accuracy: 0.9774
## 1126/1875 [=================>............] - ETA: 1s - loss: 0.0722 - accuracy: 0.9774
## 1147/1875 [=================>............] - ETA: 1s - loss: 0.0724 - accuracy: 0.9773
## 1173/1875 [=================>............] - ETA: 1s - loss: 0.0720 - accuracy: 0.9774
## 1192/1875 [==================>...........] - ETA: 1s - loss: 0.0717 - accuracy: 0.9774
## 1207/1875 [==================>...........] - ETA: 1s - loss: 0.0717 - accuracy: 0.9775
## 1225/1875 [==================>...........] - ETA: 1s - loss: 0.0721 - accuracy: 0.9773
## 1237/1875 [==================>...........] - ETA: 1s - loss: 0.0721 - accuracy: 0.9773
## 1246/1875 [==================>...........] - ETA: 1s - loss: 0.0725 - accuracy: 0.9773
## 1264/1875 [===================>..........] - ETA: 1s - loss: 0.0729 - accuracy: 0.9772
## 1298/1875 [===================>..........] - ETA: 1s - loss: 0.0729 - accuracy: 0.9772
## 1336/1875 [====================>.........] - ETA: 1s - loss: 0.0737 - accuracy: 0.9768
## 1375/1875 [=====================>........] - ETA: 1s - loss: 0.0730 - accuracy: 0.9770
## 1420/1875 [=====================>........] - ETA: 0s - loss: 0.0729 - accuracy: 0.9770
## 1460/1875 [======================>.......] - ETA: 0s - loss: 0.0725 - accuracy: 0.9771
## 1496/1875 [======================>.......] - ETA: 0s - loss: 0.0729 - accuracy: 0.9771
## 1541/1875 [=======================>......] - ETA: 0s - loss: 0.0732 - accuracy: 0.9771
## 1578/1875 [========================>.....] - ETA: 0s - loss: 0.0732 - accuracy: 0.9771
## 1615/1875 [========================>.....] - ETA: 0s - loss: 0.0729 - accuracy: 0.9772
## 1660/1875 [=========================>....] - ETA: 0s - loss: 0.0726 - accuracy: 0.9773
## 1701/1875 [==========================>...] - ETA: 0s - loss: 0.0731 - accuracy: 0.9771
## 1728/1875 [==========================>...] - ETA: 0s - loss: 0.0729 - accuracy: 0.9771
## 1772/1875 [===========================>..] - ETA: 0s - loss: 0.0733 - accuracy: 0.9771
## 1810/1875 [===========================>..] - ETA: 0s - loss: 0.0729 - accuracy: 0.9772
## 1850/1875 [============================>.] - ETA: 0s - loss: 0.0732 - accuracy: 0.9771
## 1875/1875 [==============================] - 3s 2ms/step - loss: 0.0731 - accuracy: 0.9771
## <tensorflow.python.keras.callbacks.History object at 0x000000003A8465F8>
```

```python
model.evaluate(x_test,  y_test, verbose=2)
```

```
## 313/313 - 1s - loss: 0.0727 - accuracy: 0.9778
## [0.07274838536977768, 0.9778000116348267]
```

# Evaluate
The Model.evaluate method checks the models performance, usually on a "Validation-set" or "Test-set".

The image classifier is now trained to ~98% accuracy on this dataset. To learn more, read the TensorFlow tutorials.

If you want your model to return a probability, you can wrap the trained model, and attach the softmax to it:

```python
probability_model = tf.keras.Sequential([
  model,
  tf.keras.layers.Softmax()
])

probability_model(x_test[:5])
```

```
## <tf.Tensor: shape=(5, 10), dtype=float32, numpy=
## array([[3.09387738e-09, 9.70978675e-09, 2.38318506e-07, 2.19121976e-05,
##         2.78024791e-11, 3.05041894e-08, 1.05367053e-14, 9.99972224e-01,
##         2.27436221e-08, 5.59194677e-06],
##        [1.43155077e-09, 4.57257147e-06, 9.99988675e-01, 1.14732597e-06,
##         2.35572780e-15, 5.13764962e-06, 2.37858657e-08, 1.64619661e-13,
##         4.77056687e-07, 7.50859238e-16],
##        [6.39027817e-08, 9.99446809e-01, 1.31104507e-05, 2.73696037e-06,
##         2.66442221e-05, 4.54757310e-06, 7.36744769e-05, 3.27623449e-04,
##         1.04601866e-04, 7.13489712e-08],
##        [9.99944210e-01, 1.00972999e-08, 2.80315708e-05, 9.67565086e-08,
##         1.03597847e-06, 1.19824153e-06, 4.12128747e-06, 1.02730055e-05,
##         1.26224563e-06, 9.66890912e-06],
##        [6.83824237e-06, 1.06921227e-07, 6.15242607e-06, 1.55798929e-08,
##         9.97784913e-01, 1.58457351e-06, 1.96966630e-05, 5.30385660e-05,
##         3.08452911e-07, 2.12744763e-03]], dtype=float32)>
```

# Get the results into R

```r
py$x_test %>% as_tibble()
```

```
## # A tibble: 10,000 x 784
##       V1    V2    V3    V4    V5    V6    V7    V8    V9   V10   V11   V12   V13
##    <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
##  1     0     0     0     0     0     0     0     0     0     0     0     0     0
##  2     0     0     0     0     0     0     0     0     0     0     0     0     0
##  3     0     0     0     0     0     0     0     0     0     0     0     0     0
##  4     0     0     0     0     0     0     0     0     0     0     0     0     0
##  5     0     0     0     0     0     0     0     0     0     0     0     0     0
##  6     0     0     0     0     0     0     0     0     0     0     0     0     0
##  7     0     0     0     0     0     0     0     0     0     0     0     0     0
##  8     0     0     0     0     0     0     0     0     0     0     0     0     0
##  9     0     0     0     0     0     0     0     0     0     0     0     0     0
## 10     0     0     0     0     0     0     0     0     0     0     0     0     0
## # ... with 9,990 more rows, and 771 more variables: V14 <dbl>, V15 <dbl>,
## #   V16 <dbl>, V17 <dbl>, V18 <dbl>, V19 <dbl>, V20 <dbl>, V21 <dbl>,
## #   V22 <dbl>, V23 <dbl>, V24 <dbl>, V25 <dbl>, V26 <dbl>, V27 <dbl>,
## #   V28 <dbl>, V29 <dbl>, V30 <dbl>, V31 <dbl>, V32 <dbl>, V33 <dbl>,
## #   V34 <dbl>, V35 <dbl>, V36 <dbl>, V37 <dbl>, V38 <dbl>, V39 <dbl>,
## #   V40 <dbl>, V41 <dbl>, V42 <dbl>, V43 <dbl>, V44 <dbl>, V45 <dbl>,
## #   V46 <dbl>, V47 <dbl>, V48 <dbl>, V49 <dbl>, V50 <dbl>, V51 <dbl>,
## #   V52 <dbl>, V53 <dbl>, V54 <dbl>, V55 <dbl>, V56 <dbl>, V57 <dbl>,
## #   V58 <dbl>, V59 <dbl>, V60 <dbl>, V61 <dbl>, V62 <dbl>, V63 <dbl>,
## #   V64 <dbl>, V65 <dbl>, V66 <dbl>, V67 <dbl>, V68 <dbl>, V69 <dbl>,
## #   V70 <dbl>, V71 <dbl>, V72 <dbl>, V73 <dbl>, V74 <dbl>, V75 <dbl>,
## #   V76 <dbl>, V77 <dbl>, V78 <dbl>, V79 <dbl>, V80 <dbl>, V81 <dbl>,
## #   V82 <dbl>, V83 <dbl>, V84 <dbl>, V85 <dbl>, V86 <dbl>, V87 <dbl>,
## #   V88 <dbl>, V89 <dbl>, V90 <dbl>, V91 <dbl>, V92 <dbl>, V93 <dbl>,
## #   V94 <dbl>, V95 <dbl>, V96 <dbl>, V97 <dbl>, V98 <dbl>, V99 <dbl>,
## #   V100 <dbl>, V101 <dbl>, V102 <dbl>, V103 <dbl>, V104 <dbl>, V105 <dbl>,
## #   V106 <dbl>, V107 <dbl>, V108 <dbl>, V109 <dbl>, V110 <dbl>, V111 <dbl>,
## #   V112 <dbl>, V113 <dbl>, ...
```

```r
py$predictions %>% as_tibble()
```

```
## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.
```

```
## # A tibble: 1 x 10
##          V1    V2    V3     V4     V5     V6    V7     V8    V9    V10
##       <dbl> <dbl> <dbl>  <dbl>  <dbl>  <dbl> <dbl>  <dbl> <dbl>  <dbl>
## 1 -0.000649 0.341 0.404 -0.434 0.0187 -0.310 0.553 -0.450 0.349 -0.159
```


# Source the complete python script
You can also source the complete python script with all the above command as:

```r
reticulate::source_python(
  here::here(
    "py",
    "tf_intro.py"
  )
)
```

